import{d as C,o as _,e as v,f as o,r as n,j as L,I as M,v as t,x as a,u as s,l as w,J as i,K as B,A as D,z as h,p as f,N as H,C as N,O as b,D as $,T as x}from"./index-4b96d2af.js";import{a as P,b as I,N as U}from"./Spin-bdc08f50.js";import{N as V,a as A}from"./BreadcrumbItem-020d9db8.js";import{N as K}from"./Popconfirm-4a01b1c3.js";import{N as R}from"./Space-ffa81a26.js";import"./Checkbox-32056b45.js";const j={xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",viewBox:"0 0 24 24"},q=o("g",{fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"},[o("path",{d:"M19 18v-6a3 3 0 0 0-3-3H9"}),o("path",{d:"M13 13L9 9l4-4m-5 8L4 9l4-4"})],-1),O=[q],F=C({name:"CornerUpLeftDouble",render:function(d,r){return _(),v("svg",j,O)}}),G={class:"list-page"},J={class:"header"},W={class:"title n-ellipsis"},X={key:0,class:"loading"},Y={key:0,class:"outer-wrapper static show"},Z={class:"toolbar-wrapper"},ie=C({__name:"trash",setup(T){const d=n(),r=n([]),S=n([{title:"删除时间",key:"modified_time",sorter:"default",render:e=>i(B,{time:new Date(String(e.created_time)||""),format:"MM-dd HH:MM"}),className:"modified_time",width:200},{title:"大小",key:"size",sorter:"default",render:e=>Number(e.size)>0?D(Number(e.size)):"",className:"size",width:160}]),u=n(!1),p=n(),m=()=>{u.value=!0,h.get("https://api-drive.mypikpak.com/drive/v1/files",{params:{parent_id:"*",thumbnail_size:"SIZE_LARGE",with_audit:!0,page_token:p.value||void 0,filters:{phase:{eq:"PHASE_TYPE_COMPLETE"},trashed:{eq:!0}}}}).then(e=>{const{data:l}=e;p.value||(d.value=[]),d.value=d.value.concat(l.files),p.value=l.next_page_token}).finally(()=>{u.value=!1})},k=e=>{h.post("https://api-drive.mypikpak.com/drive/v1/files:batchDelete",{ids:typeof e=="string"?[e]:e}).then(()=>{window.$message.success("删除成功"),m()})},g=e=>{h.post("https://api-drive.mypikpak.com/drive/v1/files:batchUntrash",{ids:typeof e=="string"?[e]:e}).then(()=>{m()})},z=e=>{e.target.offsetHeight-e.target.scrollTop<30&&p.value&&!u.value&&m()},y=n([{type:"selection"},{title:"名称",key:"name",sorter:"default",render:e=>i("div",{class:"file-info"},[i("img",{src:e.thumbnail_link||e.icon_link}),i(P,{class:"title"},{default:()=>String(e.name)}),i("span",{class:"action"},"1")])},{title:"操作",key:"action",width:90,align:"right",render:e=>i(R,{},{default:()=>[i(x,{type:"primary",onClick:()=>{g(String(e.id))}},{default:()=>"还原"}),i(K,{placement:"right",onPositiveClick:()=>{k(String(e.id))}},{trigger:()=>i(x,{type:"primary"},{default:()=>"删除"}),default:()=>"确定删除文件吗？"})]})}]);return L(()=>{document.body.clientWidth>968&&y.value.splice(2,0,...S.value),m()}),(e,l)=>{const E=M("router-link");return _(),v("div",G,[o("div",J,[o("div",W,[t(s(A),{separator:">"},{default:a(()=>[t(s(V),null,{default:a(()=>[t(E,{to:""},{default:a(()=>[f("回收站")]),_:1})]),_:1})]),_:1})])]),t(s(H),{style:{"max-height":"calc(100vh - 190px)"},onScroll:z},{default:a(()=>[t(s(I),{"checked-row-keys":r.value,"onUpdate:checkedRowKeys":l[0]||(l[0]=c=>r.value=c),"row-key":c=>c.id,data:d.value,size:"small",columns:y.value,bordered:!1},null,8,["checked-row-keys","row-key","data","columns"]),u.value?(_(),v("div",X,[t(s(U),{size:"small"}),f("加载中")])):w("",!0)]),_:1}),r.value.length?(_(),v("div",Y,[o("div",Z,[o("div",{class:"toolbar-item",onClick:l[1]||(l[1]=c=>g(r.value))},[t(s(b),null,{trigger:a(()=>[t(s(N),null,{default:a(()=>[t(s(F))]),_:1})]),default:a(()=>[f(" 还原所选 ")]),_:1})]),o("div",{class:"toolbar-item",onClick:l[2]||(l[2]=c=>k(r.value))},[t(s(b),null,{trigger:a(()=>[t(s(N),null,{default:a(()=>[t(s($))]),_:1})]),default:a(()=>[f(" 删除所选 ")]),_:1})])])])):w("",!0)])}}});export{ie as default};
